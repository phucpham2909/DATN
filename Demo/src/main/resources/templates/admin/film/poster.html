<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi"
	th:replace="~{/admin/layout/sidebar-layout::view(~{::title}, ~{::article})}">
<head>
<meta charset="UTF-8">
<title>Qu·∫£n l√Ω Poster</title>
<link
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
	rel="stylesheet">
</head>
<body>
	<article>
		<div class="container mt-3">
			<h3 class="mb-3 mt-3">Qu·∫£n l√Ω Poster</h3>
			<div class="row">
				<form class="d-flex align-items-center mb-3 col-lg-12"
					th:action="@{/admin/film/upload-poster}" method="post"
					enctype="multipart/form-data" style="gap: 0.5rem;">

					<select name="filmId" class="form-select" required>
						<option th:each="film : ${filmsForUpload}" th:value="${film.id}"
							th:text="${film.name}"></option>
					</select> <input type="file" name="posterFile" class="form-control" required>

					<button type="submit" class="btn btn-primary" style="width: 250px">L∆∞u
						Poster</button>
				</form>
				<form th:action="@{/admin/film/posters}" method="get"
					class="d-flex align-items-center mb-3 col-lg-8"
					style="gap: 0.5rem;">

					<input type="text" name="keyword" th:value="${keyword}"
						class="form-control" placeholder="T√¨m theo t√™n phim..." />
					<button class="btn btn-outline-primary" type="submit">üîç</button>
					<input type="hidden" name="hasPoster"
						th:value=" ${
                hasPoster == null || hasPoster == 'all' ? 'true'
                : (hasPoster == 'true' ? 'false' : 'all')
           } " />

					<button type="submit" class="btn btn-outline-primary"
						style="min-width: 150px;">
						<span
							th:text="${
            hasPoster == null || hasPoster == 'all' ? 'T·∫•t c·∫£'
            : (hasPoster == 'true' ? 'C√≥ poster' : 'Kh√¥ng c√≥ poster')
        }"></span>
					</button>
				</form>

			</div>
			<div class="table-responsive">
				<table class="table table-hover table-striped align-middle">
					<thead class="table-dark">
						<tr>
							<th style="width: 5%;">STT</th>
							<th style="width: 50%;">T√™n Phim</th>
							<th style="width: 35%;">Poster</th>
							<th style="width: 10%;">Thao t√°c</th>
						</tr>
					</thead>
					<tbody>
						<tr th:each="film, iterStat : ${films}">
							<td th:text="${iterStat.index + 1 + (currentPage * 5)}"></td>
							<td th:text="${film.name}"></td>
							<td><img th:if="${film.poster != null}"
								th:src="@{'/poster-images/' + ${film.poster}}" alt="Poster"
								style="height: 75px; width: auto; object-fit: contain;"> <span
								th:if="${film.poster == null}">Ch∆∞a c√≥ poster</span></td>
							<td>
								<form th:action="@{/admin/film/delete-poster}" method="post"
									th:if="${film.poster != null}" style="display: inline;">
									<input type="hidden" th:name="filmId" th:value="${film.id}" />
									<button type="submit" class="btn btn-danger btn-sm"
										onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a poster n√†y?')">X√≥a</button>
								</form>
							</td>
						</tr>

						<tr th:if="${#lists.isEmpty(films)}">
							<td colspan="4" class="text-center text-muted py-4">Kh√¥ng c√≥
								phim n√†o</td>
						</tr>
					</tbody>
				</table>
			</div>
		</div>
		<nav class="mt-1" th:if="${totalPages > 0}">
			<ul class="pagination justify-content-center">
				<li class="page-item"
					th:classappend="${currentPage == 0} ? 'disabled'"><a
					class="page-link"
					th:href="@{/admin/film/posters(page=0, keyword=${keyword}, hasPoster=${hasPoster})}">
						Trang ƒë·∫ßu </a></li>

				<li class="page-item"
					th:classappend="${currentPage == 0} ? 'disabled'"><a
					class="page-link"
					th:href="@{/admin/film/posters(page=${currentPage > 0 ? currentPage - 1 : 0}, keyword=${keyword}, hasPoster=${hasPoster})}">
						Trang tr∆∞·ªõc </a></li>

				<li class="page-item disabled"><span class="page-link">Trang
						[[${currentPage + 1}]] / [[${totalPages}]]</span></li>

				<li class="page-item"
					th:classappend="${currentPage + 1 >= totalPages} ? 'disabled'">
					<a class="page-link"
					th:href="@{/admin/film/posters(page=${currentPage + 1 < totalPages ? currentPage + 1 : currentPage}, keyword=${keyword}, hasPoster=${hasPoster})}">
						Trang k·∫ø </a>
				</li>

				<li class="page-item"
					th:classappend="${currentPage + 1 >= totalPages} ? 'disabled'">
					<a class="page-link"
					th:href="@{/admin/film/posters(page=${totalPages - 1}, keyword=${keyword}, hasPoster=${hasPoster})}">
						Trang cu·ªëi </a>
				</li>
			</ul>
		</nav>

	</article>
</body>
</html>
