<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi"
      th:replace="~{/admin/layout/sidebar-layout::view(~{::title}, ~{::article})}">
<head>
    <meta charset="UTF-8">
    <title>Danh s√°ch s·∫£n ph·∫©m</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<article>
    <div class="container mt-4">
        <h2>Danh s√°ch s·∫£n ph·∫©m</h2>

        <!-- Th√¥ng b√°o l·ªói / th√†nh c√¥ng -->
        <div th:if="${error}" class="alert alert-danger alert-dismissible fade show mt-2">
            <span th:text="${error}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>
        <div th:if="${success}" class="alert alert-success alert-dismissible fade show mt-2">
            <span th:text="${success}"></span>
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        </div>

        <!-- T√¨m ki·∫øm & Th√™m m·ªõi -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <form th:action="@{/admin/product/list}" method="get" class="d-flex align-items-center mb-3">
                <input type="text" name="keyword" th:value="${keyword}" class="form-control me-2"
                       placeholder="T√¨m theo t√™n s·∫£n ph·∫©m...">
                <input type="hidden" name="sort" th:value="${sort == 'asc' ? 'desc' : 'asc'}"/>
                <button type="submit" class="btn btn-outline-primary me-2" style="min-width: 80px;">
                    <span th:text="${sort == 'asc' ? 'A-Z' : 'Z-A'}"></span>
                </button>
                <button class="btn btn-outline-primary" type="submit">üîç</button>
            </form>
            <a href="/admin/product/form" class="btn btn-primary">Th√™m s·∫£n ph·∫©m m·ªõi</a>
        </div>

        <!-- B·∫£ng s·∫£n ph·∫©m -->
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
            <tr>
                <th>·∫¢nh</th>
                <th>T√™n s·∫£n ph·∫©m</th>
                <th>M√¥ t·∫£</th>
                <th>Gi√°</th>
                <th>Tr·∫°ng th√°i</th>
                <th>Danh m·ª•c</th>
                <th>H√†nh ƒë·ªông</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="item : ${products}">
                <td>
                    <img th:if="${item.images != null}"
                         th:src="${item.images}"
                         style="width: 60px; height: 80px; object-fit: cover;"/>
                </td>
                <td th:text="${item.name}"></td>
                <td th:text="${item.description}"></td>
                <td th:text="${#numbers.formatDecimal(item.price, 1, 'POINT', 0, 'COMMA')} + ' VNƒê'"></td>
                <td>
                    <span th:classappend="${item.active} ? 'badge bg-secondary' : 'badge bg-success'"
                          th:text="${item.active} ? '·∫®n' : 'Hi·ªÉn th·ªã'"></span>
                </td>
                <td th:text="${item.categoryProduct != null ? item.categoryProduct.name : 'Kh√¥ng c√≥'}"></td>
                <td>
                    <a th:href="@{'/admin/product/form?id=' + ${item.id}}" class="btn btn-sm btn-warning">S·ª≠a</a>
                    <a th:href="@{'/admin/product/delete/' + ${item.id}}" class="btn btn-danger btn-sm"
                       onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a?')">X√≥a</a>
                </td>
            </tr>
            </tbody>
        </table>

        <!-- Ph√¢n trang -->
        <nav class="mt-3" th:if="${products.totalPages > 0}">
            <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${products.first} ? 'disabled'">
                    <a class="page-link" th:href="@{/admin/product/list(page=0, keyword=${keyword}, sort=${sort})}">Trang ƒë·∫ßu</a>
                </li>
                <li class="page-item" th:classappend="${products.first} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/product/list(page=${products.number > 0 ? products.number - 1 : 0}, keyword=${keyword}, sort=${sort})}">Trang tr∆∞·ªõc</a>
                </li>
                <li class="page-item disabled">
                    <span class="page-link">Trang [[${products.number + 1}]] / [[${products.totalPages}]]</span>
                </li>
                <li class="page-item" th:classappend="${products.last} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/product/list(page=${products.number + 1 < products.totalPages ? products.number + 1 : products.number}, keyword=${keyword}, sort=${sort})}">Trang k·∫ø</a>
                </li>
                <li class="page-item" th:classappend="${products.last} ? 'disabled'">
                    <a class="page-link"
                       th:href="@{/admin/product/list(page=${products.totalPages - 1}, keyword=${keyword}, sort=${sort})}">Trang cu·ªëi</a>
                </li>
            </ul>
        </nav>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</article>
</body>
</html>
