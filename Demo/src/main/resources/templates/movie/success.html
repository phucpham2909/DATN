<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org"
      th:replace="~{layout/layout2 :: layout(~{::head}, ~{::body})}">
<body>
  <div class="container text-center" id="ticket-container">
    <h3 class="fw-bold text-success mt-3">ğŸ‰ Thanh toÃ¡n thÃ nh cÃ´ng!</h3>
    <p class="text-muted">VÃ© cá»§a báº¡n Ä‘Ã£ Ä‘Æ°á»£c xÃ¡c nháº­n, hÃ£y lÆ°u láº¡i mÃ£ vÃ© bÃªn dÆ°á»›i.</p>
  </div>

  <script>
    async function loadTicket() {
      const params = new URLSearchParams(window.location.search);
      const movieId = params.get("movieId");
      const seats = params.get("seats");

      if (!movieId || !seats) {
        document.getElementById("ticket-container").innerHTML = "<p class='text-danger'>Thiáº¿u thÃ´ng tin vÃ©!</p>";
        return;
      }

      const res = await fetch(`/api/booking/success?movieId=${movieId}&seats=${seats}`);
      const ticket = await res.json();

      const seatList = ticket.seats.join(", ");

      document.getElementById("ticket-container").innerHTML += `
        <div class="card mx-auto mt-4 shadow" style="max-width: 500px;">
          <div class="card-body">
            <h5 class="card-title mb-3">ğŸ« MÃ£ vÃ©: <strong>${ticket.ticketId}</strong></h5>
            <img src="${ticket.movie.image}" class="img-fluid rounded mb-3" alt="${ticket.movie.title}">
            <h5>${ticket.movie.title}</h5>
            <p><strong>Ráº¡p:</strong> ${ticket.cinema}</p>
            <p><strong>Suáº¥t chiáº¿u:</strong> ${ticket.showtime}</p>
            <p><strong>Gháº¿:</strong> ${seatList}</p>
            <p><strong>Thá»i gian Ä‘áº·t:</strong> ${ticket.bookingTime}</p>
            <p class="text-success fw-bold">${ticket.status}</p>
            <hr>
            <button class="btn btn-outline-primary" onclick="window.print()">ğŸ–¨ In vÃ©</button>
            <a href="/home" class="btn btn-success">Vá» trang chá»§</a>
          </div>
        </div>
      `;
    }

    loadTicket();
  </script>
</body>
</html>
